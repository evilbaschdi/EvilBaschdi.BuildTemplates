jobs:
  - job: PushNuget
    pool:
      name: x-agentpool
    variables:
      buildPlatform: "Any CPU"
      buildConfiguration: "Release"

    steps:
      - task: DownloadPipelineArtifact@2
        displayName: "Download Nuget-Package Artifact"
        inputs:
          artifact: "Nuget-Package"
          path: "$(Pipeline.Workspace)/Nuget-Package"

      - task: UseDotNet@2
        displayName: "Use .Net Core sdk from global.json"
        inputs:
          useGlobalJson: true
          includePreviewVersions: true

      - task: DotNetCoreCLI@2
        displayName: "dotnet push evilfeed"
        inputs:
          command: push
          packagesToPush: "$(Pipeline.Workspace)/Nuget-Package/*.nupkg"
          publishVstsFeed: "652346b9-9a10-49f8-a49a-f79b3ec66045"
        continueOnError: true

      - task: DotNetCoreCLI@2
        displayName: "dotnet push MyGet"
        inputs:
          command: push
          packagesToPush: "$(Pipeline.Workspace)/Nuget-Package/*.nupkg"
          nuGetFeedType: external
          publishFeedCredentials: "myGet Feed"
        continueOnError: true
